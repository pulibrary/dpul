name: dpul
services:
  dpul_db:
    type: postgres:15
    portforward: true
  dpul_development_solr:
    type: solr:custom
    overrides:
      image: pulibrary/ci-solr:8.4-v1.0.0
      command: server/scripts/lando-start.sh
    portforward: true
    core: blacklight-core
    config:
      dir: solr/config
  dpul_test_solr:
    type: solr:custom
    overrides:
      image: pulibrary/ci-solr:8.4-v1.0.0
      command: server/scripts/lando-start.sh
    portforward: true
    core: blacklight-core-test
    config:
      dir: solr/config
  dpul_chrome:
    type: compose
    app_mount: false
    services:
      image: seleniarm/standalone-chromium:114.0
      environment:
        START_XVFB: "true"
        SE_NODE_MAX_SESSIONS: 20
        SE_NODE_OVERRIDE_MAX_SESSIONS: "true"
      logging:
        driver: none
      shm_size: 2G
      ports:
        - "4445:4444"
        - "5900:5900"
        - "7900:7900"
      volumes:
        - /dev/shm:/dev/shm
      command: /opt/bin/entry_point.sh
    portforward: true
  redis:
    type: redis:7
    portforward: true
